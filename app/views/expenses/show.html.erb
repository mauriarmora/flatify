<%= render '/shared/navbar' %>
<div class="category-exp-<%= @expense.category.downcase %>">
  <div class="total-amount-exp">
    <h1><strong>‚Ç¨ <%= format_cost(@expense.amount.round(2)) %></strong></h1>
  </div>
</div>

<div class="wrapper-exp">
  <div class="container pt-5">
    <div class="information-exp-body">

      <div class="creator-card">
        <p>Created by</p>
        <div class="small-avatar" style="background-image: url(<%= @creator.photo_url %>)"></div>
      </div>

      <div class="exp-date">
        <div class="backbutn">
          <%= link_to '<i class="fas fa-arrow-left back-arrow"></i>'.html_safe, root_path %>
        </div>
        <p><strong>From:</strong> <%= @expense.created_at.strftime("%d %B %Y") %></p>
      </div>

      <div class="user-amount-<%= @expense.category.downcase %> p-3">
        <h2>You have to pay</h2>
        <h2>‚Ç¨ <%= format_cost(@user_amount.round(2)) %></h2>
      </div>

      <div class="expense-information">
        <h3 class="exp-cat mt-4 mb-3"><strong> <%= @expense.category %> </strong></h3>
        <h3>Description</h3>
        <p> <%= @expense.description.capitalize %> </p>

        <% if @expense.photo.attached? %>
        <%= image_tag @expense.photo.service_url, class:'exp-imag' %>
        <% else %>
        <%= "" %>
        <% end %>

        <h3 class="shared-with mb-3">Shared with</h3>

          <div class="expenses">
            <% @expense.users.each do |user| %>
              <div class="card-expense">
                <div class="small-avatar" style="background-image: url(<%= user.photo_url %>)"></div>
                <div class="color-separator expense-category-<%= @expense.category.downcase %>"></div>
                <div class="expense-info">
                  <h3> <%= user.first_name %> </h3>
                </div>
                <div class="card-price">
                  <h2 id="expense-card-bold">‚Ç¨ <%= format_cost(@user_amount.round(2)) %> </h2>
                </div>
              </div>
             <% end %>
          </div>
          <h3>Comments üìù</h3>
          <div class="comment-box mt-3">
            <% if @expense.comments.blank? %>
              <div class="comment-blank mb-3">Be the first to leave a comment!!</div>
            <% else %>
            <% @comments.each do |comment| %>
                <div class="comment-card" id="<%=comment.id%>-review">

                  <div class="comment-info">
                    <div class="small-avatar" style="background-image: url(<%= comment.user.photo_url %>)"></div>
                    <div class="comment-user-data">
                      <p><strong><%= comment.user.first_name %></strong></p>
                      <p class="date-string"><%= comment.created_at.strftime("%d %B %Y") %></p>
                    </div>
                  </div>

                  <div class="comment-cont">
                    <p><%= comment.content %></p>
                  </div>

                </div>
              <% end %>
            <% end %>
          </div>
          <h3>Leave a comment üìù</h3>

            <%= simple_form_for([ @expense, @comment ]) do |f| %>
              <%= f.input :content, as: :text, placeholder: 'Type a comment', label: false, input_html: { class: "comment-cont-input"} %>
              <%= f.button :submit %>
            <% end %>

        </div>
      </div>
    </div>
    </div>
  </div>
</div>
